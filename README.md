# 视频语言学习助手

一款专为语言学习者设计的视频重复播放工具，帮助您通过视频内容高效学习语言。

<div align="center">
  <img src="docs/images/app_home_page_screen.png" alt="应用截图" width="800"/>
</div>

## 下载安装

[![下载安装包](https://img.shields.io/github/v/release/ericfetch/video_repeater?label=下载&style=for-the-badge)](https://github.com/ericfetch/video_repeater/releases)

> **提示**：点击上方按钮下载最新版本的安装包

## 功能特点

- **视频播放**：支持多种视频格式，流畅播放
- **YouTube集成**：支持直接输入YouTube链接播放视频和字幕，且自动下载到指定目录
- **字幕控制**：加载并显示SRT格式字幕，支持字幕模糊化（用于测试理解能力）
- **字幕自动匹配**：根据视频文件名自动查找匹配的字幕文件，支持同名匹配和后缀匹配
- **字幕同步**：支持调整字幕时间偏移，解决字幕不同步问题
- **循环播放**：可按字幕单位循环播放视频片段，帮助记忆和理解
- **生词本**：选中字幕中的单词即可添加到生词本，支持平铺模式和导出功能
- **历史记录**：自动保存观看历史，随时可以继续上次的学习进度
- **快捷键**：丰富的键盘快捷键，提高学习效率
- **自定义设置**：可调整播放速度、字幕样式等多项设置
- **悬浮控制栏**：视频播放时控制栏会自动隐藏，鼠标移动到顶部时显示
- **自动恢复**：应用启动时自动恢复上次的播放状态

## 安装方法

### Windows

1. 下载最新的[安装包](https://github.com/ericfetch/video_repeater/releases)
2. 双击运行安装程序 `VideoRepeater-Setup.exe`
3. 按照向导提示完成安装
4. 从桌面或开始菜单启动应用

## 使用说明

### 基本操作

1. 点击工具栏中的"选择视频"按钮，选择要学习的视频文件
2. 字幕会自动匹配加载（如果启用了自动匹配功能），或点击"选择字幕"按钮手动选择字幕
3. 使用播放控制按钮或键盘快捷键控制视频播放

### 键盘快捷键

- **空格键**：播放/暂停
- **左箭头**：回退5秒
- **右箭头**：前进5秒
- **上箭头**：上一句字幕
- **下箭头**：下一句字幕
- **R键**：切换循环模式
- **S键**：切换字幕模糊显示

### 字幕自动匹配

应用支持自动匹配字幕文件，无需每次手动选择：

1. 在设置中启用"自动匹配字幕"功能
2. 选择匹配模式：
   - **与视频同名**：查找与视频文件同名的SRT字幕文件
   - **添加后缀**：查找带有指定后缀的SRT字幕文件（如video_en.srt）
   - **两者都尝试**：先尝试同名匹配，如果失败再尝试后缀匹配
3. 如果选择"添加后缀"模式，可以自定义后缀列表（如_en, .en, -en等）
4. 加载视频时，应用会自动查找并加载匹配的字幕文件

### 使用YouTube视频

应用支持直接播放YouTube视频，无需下载：

1. 点击工具栏中的"YouTube视频"按钮
2. 在输入框中粘贴YouTube视频链接（例如：https://www.youtube.com/watch?v=xxxx）
3. 点击"加载"按钮，应用会自动加载视频和可用的字幕
4. 字幕会自动选择合适的语言（优先选择中文，其次是英文）
5. 所有本地视频的功能（如循环播放、字幕控制等）同样适用于YouTube视频

> **注意**：使用YouTube功能需要网络连接。应用不会下载或存储YouTube视频，而是通过嵌入式播放器直接播放。

### 生词本使用

1. 播放视频时，选中字幕中不认识的单词
2. 右键点击，选择"添加到生词本"
3. 点击工具栏中的"生词本"按钮查看已保存的单词
4. 可切换"分组视图"和"平铺视图"两种显示模式
   - 分组视图：按视频分组显示单词
   - 平铺视图：将所有单词合并显示，按添加时间排序
5. 点击"导出"按钮可将生词本导出为文本或表格格式，方便打印或导入其他软件

### 设置选项

点击工具栏中的"设置"按钮，可以调整以下选项：

- 播放速度选项
- 默认播放速度
- 循环等待间隔
- 字幕字体大小
- 字幕字体粗细
- 字幕颜色
- 字幕背景颜色
- 字幕自动匹配设置
  - 启用/禁用自动匹配
  - 匹配模式（同名匹配/后缀匹配/两者都尝试）
  - 自定义后缀列表
- 界面主题（明亮/暗黑模式）

## 系统要求

- Windows 10/11 64位系统
- 至少4GB内存
- 至少100MB可用磁盘空间
- 安装 [K-Lite Codec Pack](https://codecguide.com/download_kl.htm) 以获得最佳播放体验

## 更新日志

### v1.1.4 (2024-05-01)重大更新
- 添加YouTube视频集成功能，支持直接播放YouTube视频和字幕，自动下载到本地，下次匹配可自动用本地资源避免重复下载
- 暂时匹配720p资源，因为youtube平台诸多限制，资源质量的下载灵活性有待解决
- 优化YouTube视频字幕循环播放功能，支持与本地视频相同的循环体验
- 设置页面可配置youtube保存路径

### v1.1.3 (2023-12-10)
- 添加字幕时间调整功能，解决字幕同步问题
- 优化字幕时间偏移功能，修复字幕同步问题
- 改进字幕时间偏移UI设计，使控制按钮更加明显
- 添加关闭应用时的保存进度提示，提升用户体验
- 新增生词本平铺模式，便于整体复习单词
- 添加生词本导出功能，支持TXT和CSV格式，方便打印和导入其他软件
- 优化生词本分组视图，不再显示没有生词的视频，使界面更加简洁
- 添加音量图标点击功能，支持一键静音和恢复音量
- 添加字幕自动匹配功能，支持同名匹配和后缀匹配，提升用户体验
- 优化设置界面，解决输入框闪烁问题，提高交互稳定性
- 修复字幕上一句/下一句跳转偶尔跳转过远的问题，尤其在视频片头附近

### v1.1.2 (2023-11-25)
- 修复无字幕时视频无法加载的问题
- 优化应用关闭时的体验，关闭前自动暂停视频
- 添加全局服务引用，提高代码可维护性
- 增强视频播放状态的自动保存和恢复功能

### v1.1.1 (2023-11-22)
- 修复视频暂停时AppBar不隐藏的问题
- 修复空格键触发视频选择窗口的bug
- 改进视频播放体验和界面交互

### v1.1.0 (2023-11-20)
- 添加悬浮透明AppBar，改进视频播放体验
- 优化鼠标交互，只在顶部区域才显示控制栏
- 修复上一句/下一句功能的稳定性问题
- 添加自动隐藏控制栏功能

### v1.0.0 (2023-11-10)
- 首次发布
- 基本视频播放和字幕功能
- 生词本和历史记录功能


## 常见问题

**Q: 为什么视频无法播放？**  
A: 请确保您的系统已安装必要的视频解码器。本应用使用media_kit库，大多数常见格式应该可以直接播放。

**Q: 字幕格式有哪些要求？**  
A: 目前仅支持SRT格式的字幕文件，请确保编码为UTF-8。

**Q: 如何解决字幕与视频不同步的问题？**  
A: 可以使用字幕时间调整功能，通过界面上的"+"和"-"按钮或键盘快捷键（逗号和句号键）来调整字幕时间偏移，直到字幕与视频同步。调整后的偏移值会自动保存。

**Q: 如何导出生词本？**  
A: 在生词本页面点击右上角的"导出"按钮，可以选择导出为文本格式(TXT)或表格格式(CSV)。文本格式适合阅读和打印，表格格式适合导入Excel等软件进行进一步处理。

**Q: 如何备份我的生词本？**  
A: 生词本数据保存在应用数据目录中，您可以在设置中导出生词本。

**Q: 应用关闭后会保存我的播放进度吗？**  
A: 会的，应用会自动保存您的播放进度，下次启动时会自动恢复到上次的播放位置。

**Q: 如何使用字幕自动匹配功能？**  
A: 在设置中启用"自动匹配字幕"功能，并选择匹配模式（与视频同名、添加后缀或两者都尝试）。加载视频时，应用会自动查找匹配的字幕文件并加载。如果选择后缀匹配，可以自定义后缀列表，例如"_en"、".en"等。

**Q: 字幕自动匹配不起作用怎么办？**  
A: 请检查以下几点：1) 确认在设置中已启用自动匹配功能；2) 确认字幕文件与视频位于同一目录下；3) 如果使用后缀匹配模式，确认字幕文件名格式正确（如video_en.srt）；4) 确认字幕文件是SRT格式。如果仍然无法自动匹配，可以使用"选择字幕"按钮手动加载字幕。

**Q: 为什么使用上一句/下一句功能时有时会跳转很远？**  
A: 这种情况通常发生在字幕密度不均匀的区域，特别是在视频片头或片尾附近。最新版本已修复此问题，如果您仍然遇到此问题，可以尝试使用左右箭头键进行小幅度调整，或直接点击进度条跳转到所需位置。

**Q: 如何使用YouTube视频功能？**  
A: 点击应用顶部工具栏中的"YouTube视频"按钮，在打开的页面中粘贴YouTube视频链接（例如：https://www.youtube.com/watch?v=xxxx），然后点击"加载"按钮。应用会自动加载视频和可用的字幕。所有本地视频的功能（如循环播放、字幕控制等）同样适用于YouTube视频。

**Q: YouTube视频播放时没有字幕怎么办？**  
A: 应用会自动尝试加载YouTube视频的字幕，但并非所有YouTube视频都有字幕。如果视频没有字幕，或者没有您需要的语言的字幕，应用将无法显示字幕。您可以尝试寻找有字幕的其他类似视频，或者使用第三方工具为视频添加字幕后再使用本地播放功能。

